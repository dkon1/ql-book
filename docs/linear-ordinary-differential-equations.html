<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Linear ordinary differential equations | Quantifying Life</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Linear ordinary differential equations | Quantifying Life" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Linear ordinary differential equations | Quantifying Life" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Dmitry Kondrashov" />


<meta name="date" content="2020-09-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-difference-equations.html"/>
<link rel="next" href="graphical-analysis-of-ordinary-differential-equations.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"> Quantifying Life (Web version) </a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Purpose and purview</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#a-brief-motivation-of-mathematical-modeling"><i class="fa fa-check"></i><b>0.1</b> A brief motivation of mathematical modeling</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#purpose-of-this-book"><i class="fa fa-check"></i><b>0.2</b> Purpose of this book</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#organization-of-the-book"><i class="fa fa-check"></i><b>0.3</b> Organization of the book</a></li>
</ul></li>
<li class="part"><span><b>I The Basics</b></span></li>
<li class="chapter" data-level="1" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html"><i class="fa fa-check"></i><b>1</b> Arithmetic and variables</a>
<ul>
<li class="chapter" data-level="1.1" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#sec:bio1"><i class="fa fa-check"></i><b>1.1</b> Blood circulation and mathematical modeling</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#galens-theory-of-blood"><i class="fa fa-check"></i><b>1.1.1</b> Galen’s theory of blood</a></li>
<li class="chapter" data-level="1.1.2" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#mathematical-testing-of-the-theory"><i class="fa fa-check"></i><b>1.1.2</b> Mathematical testing of the theory</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#sec:math1"><i class="fa fa-check"></i><b>1.2</b> Parameters and variables in models</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#discrete-state-variables-genetics"><i class="fa fa-check"></i><b>1.2.1</b> discrete state variables: genetics</a></li>
<li class="chapter" data-level="1.2.2" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#discrete-state-variables-population"><i class="fa fa-check"></i><b>1.2.2</b> discrete state variables: population</a></li>
<li class="chapter" data-level="1.2.3" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#continuous-state-variables-concentration"><i class="fa fa-check"></i><b>1.2.3</b> continuous state variables: concentration</a></li>
<li class="chapter" data-level="1.2.4" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#multiple-variables-in-medicine"><i class="fa fa-check"></i><b>1.2.4</b> multiple variables in medicine</a></li>
<li class="chapter" data-level="1.2.5" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#discussion-questions"><i class="fa fa-check"></i><b>1.2.5</b> Discussion questions</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#first-steps-in-r"><i class="fa fa-check"></i><b>1.3</b> First steps in R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#r-markdown-and-r-studio"><i class="fa fa-check"></i><b>1.3.1</b> R Markdown and R Studio</a></li>
<li class="chapter" data-level="1.3.2" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#numbers-and-arithmetic-operations"><i class="fa fa-check"></i><b>1.3.2</b> numbers and arithmetic operations</a></li>
<li class="chapter" data-level="1.3.3" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#r-coding-exercises"><i class="fa fa-check"></i><b>1.3.3</b> R Coding Exercises</a></li>
<li class="chapter" data-level="1.3.4" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#variable-assignment"><i class="fa fa-check"></i><b>1.3.4</b> variable assignment</a></li>
<li class="chapter" data-level="1.3.5" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#r-coding-exercises-1"><i class="fa fa-check"></i><b>1.3.5</b> R Coding Exercises</a></li>
<li class="chapter" data-level="1.3.6" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#exercises"><i class="fa fa-check"></i><b>1.3.6</b> Exercises:</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#r-assignment"><i class="fa fa-check"></i><b>1.4</b> R Assignment</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html"><i class="fa fa-check"></i><b>2</b> Functions and their graphs</a>
<ul>
<li class="chapter" data-level="2.1" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#sec:model2"><i class="fa fa-check"></i><b>2.1</b> Dimensions of quantities</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#exercises"><i class="fa fa-check"></i><b>2.1.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#sec:math2"><i class="fa fa-check"></i><b>2.2</b> Functions and their graphs</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#linear-and-exponential-functions"><i class="fa fa-check"></i><b>2.2.1</b> linear and exponential functions</a></li>
<li class="chapter" data-level="2.2.2" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#exercises-1"><i class="fa fa-check"></i><b>2.2.2</b> Exercises</a></li>
<li class="chapter" data-level="2.2.3" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#rational-and-logistic-functions"><i class="fa fa-check"></i><b>2.2.3</b> rational and logistic functions</a></li>
<li class="chapter" data-level="2.2.4" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#exercises-2"><i class="fa fa-check"></i><b>2.2.4</b> Exercises:</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#vectors-and-plotting-in-r"><i class="fa fa-check"></i><b>2.3</b> Vectors and plotting in R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#writing-scripts-and-calling-functions"><i class="fa fa-check"></i><b>2.3.1</b> writing scripts and calling functions</a></li>
<li class="chapter" data-level="2.3.2" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#vector-variables"><i class="fa fa-check"></i><b>2.3.2</b> vector variables</a></li>
<li class="chapter" data-level="2.3.3" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#calculations-with-vector-variables"><i class="fa fa-check"></i><b>2.3.3</b> calculations with vector variables</a></li>
<li class="chapter" data-level="2.3.4" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#exercises-3"><i class="fa fa-check"></i><b>2.3.4</b> Exercises</a></li>
<li class="chapter" data-level="2.3.5" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#plotting-with-vectors"><i class="fa fa-check"></i><b>2.3.5</b> Plotting with vectors</a></li>
<li class="chapter" data-level="2.3.6" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#exercises-4"><i class="fa fa-check"></i><b>2.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#rates-of-biochemical-reactions"><i class="fa fa-check"></i><b>2.4</b> Rates of biochemical reactions</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#constant-zeroth-order-kinetics"><i class="fa fa-check"></i><b>2.4.1</b> Constant (zeroth-order) kinetics</a></li>
<li class="chapter" data-level="2.4.2" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#first-order-kinetics"><i class="fa fa-check"></i><b>2.4.2</b> First-order kinetics</a></li>
<li class="chapter" data-level="2.4.3" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#michaelis-menten-model-of-enzyme-kinetics"><i class="fa fa-check"></i><b>2.4.3</b> Michaelis-Menten model of enzyme kinetics </a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#r-assignment"><i class="fa fa-check"></i><b>2.5</b> R Assignment</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="describing-data-sets.html"><a href="describing-data-sets.html"><i class="fa fa-check"></i><b>3</b> Describing data sets</a>
<ul>
<li class="chapter" data-level="3.1" data-path="describing-data-sets.html"><a href="describing-data-sets.html#mutations-and-their-rates"><i class="fa fa-check"></i><b>3.1</b> Mutations and their rates</a></li>
<li class="chapter" data-level="3.2" data-path="describing-data-sets.html"><a href="describing-data-sets.html#describing-data-sets-1"><i class="fa fa-check"></i><b>3.2</b> Describing data sets</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="describing-data-sets.html"><a href="describing-data-sets.html#central-value-of-a-data-set"><i class="fa fa-check"></i><b>3.2.1</b> central value of a data set</a></li>
<li class="chapter" data-level="3.2.2" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#exercises"><i class="fa fa-check"></i><b>3.2.2</b> Exercises</a></li>
<li class="chapter" data-level="3.2.3" data-path="describing-data-sets.html"><a href="describing-data-sets.html#spread-of-a-data-set"><i class="fa fa-check"></i><b>3.2.3</b> spread of a data set</a></li>
<li class="chapter" data-level="3.2.4" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#exercises-1"><i class="fa fa-check"></i><b>3.2.4</b> Exercises:</a></li>
<li class="chapter" data-level="3.2.5" data-path="describing-data-sets.html"><a href="describing-data-sets.html#describing-data-sets-in-graphs"><i class="fa fa-check"></i><b>3.2.5</b> describing data sets in graphs</a></li>
<li class="chapter" data-level="3.2.6" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#exercises-2"><i class="fa fa-check"></i><b>3.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="describing-data-sets.html"><a href="describing-data-sets.html#working-with-data-in-r"><i class="fa fa-check"></i><b>3.3</b> Working with data in R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="describing-data-sets.html"><a href="describing-data-sets.html#reading-in-data-into-data-frames"><i class="fa fa-check"></i><b>3.3.1</b> reading in data into data frames</a></li>
<li class="chapter" data-level="3.3.2" data-path="describing-data-sets.html"><a href="describing-data-sets.html#descriptive-statistics"><i class="fa fa-check"></i><b>3.3.2</b> descriptive statistics</a></li>
<li class="chapter" data-level="3.3.3" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#exercises-3"><i class="fa fa-check"></i><b>3.3.3</b> Exercises:</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#r-assignment"><i class="fa fa-check"></i><b>3.4</b> R Assignment</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>4</b> Linear regression</a>
<ul>
<li class="chapter" data-level="4.1" data-path="linear-regression.html"><a href="linear-regression.html#linear-relationship-between-two-variables"><i class="fa fa-check"></i><b>4.1</b> Linear relationship between two variables</a></li>
<li class="chapter" data-level="4.2" data-path="linear-regression.html"><a href="linear-regression.html#linear-least-squares-fitting"><i class="fa fa-check"></i><b>4.2</b> Linear least-squares fitting</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="linear-regression.html"><a href="linear-regression.html#sum-of-squared-errors"><i class="fa fa-check"></i><b>4.2.1</b> sum of squared errors</a></li>
<li class="chapter" data-level="4.2.2" data-path="linear-regression.html"><a href="linear-regression.html#best-fit-slope-and-intercept"><i class="fa fa-check"></i><b>4.2.2</b> best-fit slope and intercept</a></li>
<li class="chapter" data-level="4.2.3" data-path="linear-regression.html"><a href="linear-regression.html#execises"><i class="fa fa-check"></i><b>4.2.3</b> Execises</a></li>
<li class="chapter" data-level="4.2.4" data-path="linear-regression.html"><a href="linear-regression.html#correlation-and-goodness-of-fit"><i class="fa fa-check"></i><b>4.2.4</b> correlation and goodness of fit}</a></li>
<li class="chapter" data-level="4.2.5" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#exercises"><i class="fa fa-check"></i><b>4.2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="linear-regression.html"><a href="linear-regression.html#linear-regression-using-r"><i class="fa fa-check"></i><b>4.3</b> Linear regression using R</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#exercises-1"><i class="fa fa-check"></i><b>4.3.1</b> Exercises:</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="linear-regression.html"><a href="linear-regression.html#regression-to-the-mean"><i class="fa fa-check"></i><b>4.4</b> Regression to the mean</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#discussion-questions"><i class="fa fa-check"></i><b>4.4.1</b> Discussion questions</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#r-assignment"><i class="fa fa-check"></i><b>4.5</b> R Assignment</a></li>
</ul></li>
<li class="part"><span><b>II Things that change over time</b></span></li>
<li class="chapter" data-level="5" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html"><i class="fa fa-check"></i><b>5</b> Linear difference equations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#discrete-time-population-models"><i class="fa fa-check"></i><b>5.1</b> Discrete time population models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#static-population"><i class="fa fa-check"></i><b>5.1.1</b> static population</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#exponential-population-growth"><i class="fa fa-check"></i><b>5.1.2</b> exponential population growth</a></li>
<li class="chapter" data-level="5.1.3" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#population-with-births-and-deaths"><i class="fa fa-check"></i><b>5.1.3</b> population with births and deaths</a></li>
<li class="chapter" data-level="5.1.4" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#dimensions-of-birth-and-death-rates"><i class="fa fa-check"></i><b>5.1.4</b> dimensions of birth and death rates</a></li>
<li class="chapter" data-level="5.1.5" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#linear-demographic-models"><i class="fa fa-check"></i><b>5.1.5</b> linear demographic models</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#solutions-of-linear-difference-models"><i class="fa fa-check"></i><b>5.2</b> Solutions of linear difference models</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#simple-linear-models"><i class="fa fa-check"></i><b>5.2.1</b> simple linear models</a></li>
<li class="chapter" data-level="5.2.2" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#models-with-a-constant-term"><i class="fa fa-check"></i><b>5.2.2</b> models with a constant term</a></li>
<li class="chapter" data-level="5.2.3" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#population-growth-and-decline"><i class="fa fa-check"></i><b>5.2.3</b> population growth and decline</a></li>
<li class="chapter" data-level="5.2.4" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#exercises"><i class="fa fa-check"></i><b>5.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#numerical-solutions-in-r"><i class="fa fa-check"></i><b>5.3</b> Numerical solutions in R</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#for-loops"><i class="fa fa-check"></i><b>5.3.1</b> for loops</a></li>
<li class="chapter" data-level="5.3.2" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#using-vectors-with-loops"><i class="fa fa-check"></i><b>5.3.2</b> using vectors with loops</a></li>
<li class="chapter" data-level="5.3.3" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#exercises-1"><i class="fa fa-check"></i><b>5.3.3</b> Exercises:</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#r-assignment"><i class="fa fa-check"></i><b>5.4</b> R Assignment</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-ordinary-differential-equations.html"><a href="linear-ordinary-differential-equations.html"><i class="fa fa-check"></i><b>6</b> Linear ordinary differential equations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="linear-ordinary-differential-equations.html"><a href="linear-ordinary-differential-equations.html#building-differential-equations"><i class="fa fa-check"></i><b>6.1</b> Building differential equations</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="linear-ordinary-differential-equations.html"><a href="linear-ordinary-differential-equations.html#from-discrete-time-to-continuous"><i class="fa fa-check"></i><b>6.1.1</b> from discrete time to continuous</a></li>
<li class="chapter" data-level="6.1.2" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#exercises"><i class="fa fa-check"></i><b>6.1.2</b> Exercises</a></li>
<li class="chapter" data-level="6.1.3" data-path="linear-ordinary-differential-equations.html"><a href="linear-ordinary-differential-equations.html#growth-proportional-to-population-size"><i class="fa fa-check"></i><b>6.1.3</b> growth proportional to population size</a></li>
<li class="chapter" data-level="6.1.4" data-path="linear-ordinary-differential-equations.html"><a href="linear-ordinary-differential-equations.html#chemical-kinetics"><i class="fa fa-check"></i><b>6.1.4</b> chemical kinetics</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="linear-ordinary-differential-equations.html"><a href="linear-ordinary-differential-equations.html#solutions-of-ordinary-differential-equations"><i class="fa fa-check"></i><b>6.2</b> Solutions of ordinary differential equations</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="linear-ordinary-differential-equations.html"><a href="linear-ordinary-differential-equations.html#separate-and-integrate-method"><i class="fa fa-check"></i><b>6.2.1</b> separate and integrate method</a></li>
<li class="chapter" data-level="6.2.2" data-path="linear-ordinary-differential-equations.html"><a href="linear-ordinary-differential-equations.html#behavior-of-solutions-of-linear-odes"><i class="fa fa-check"></i><b>6.2.2</b> behavior of solutions of linear ODEs</a></li>
<li class="chapter" data-level="6.2.3" data-path="linear-ordinary-differential-equations.html"><a href="linear-ordinary-differential-equations.html#solutions-of-inhomogeneous-odes"><i class="fa fa-check"></i><b>6.2.3</b> solutions of inhomogeneous ODEs</a></li>
<li class="chapter" data-level="6.2.4" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#exercises-1"><i class="fa fa-check"></i><b>6.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="linear-ordinary-differential-equations.html"><a href="linear-ordinary-differential-equations.html#numeric-solutions-and-the-forward-euler-method"><i class="fa fa-check"></i><b>6.3</b> Numeric solutions and the Forward Euler method</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#exercises-2"><i class="fa fa-check"></i><b>6.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="linear-ordinary-differential-equations.html"><a href="linear-ordinary-differential-equations.html#forward-euler-method-in-r"><i class="fa fa-check"></i><b>6.4</b> Forward Euler method in R</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="linear-ordinary-differential-equations.html"><a href="linear-ordinary-differential-equations.html#implementation"><i class="fa fa-check"></i><b>6.4.1</b> implementation</a></li>
<li class="chapter" data-level="6.4.2" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#exercises-3"><i class="fa fa-check"></i><b>6.4.2</b> Exercises</a></li>
<li class="chapter" data-level="6.4.3" data-path="linear-ordinary-differential-equations.html"><a href="linear-ordinary-differential-equations.html#error-analysis"><i class="fa fa-check"></i><b>6.4.3</b> error analysis</a></li>
<li class="chapter" data-level="6.4.4" data-path="functions-and-their-graphs.html"><a href="functions-and-their-graphs.html#exercises-4"><i class="fa fa-check"></i><b>6.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="linear-ordinary-differential-equations.html"><a href="linear-ordinary-differential-equations.html#applications-of-linear-ode-models"><i class="fa fa-check"></i><b>6.5</b> Applications of linear ODE models</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="linear-ordinary-differential-equations.html"><a href="linear-ordinary-differential-equations.html#model-of-pharmacokinetics"><i class="fa fa-check"></i><b>6.5.1</b> model of pharmacokinetics</a></li>
<li class="chapter" data-level="6.5.2" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#discussion-questions"><i class="fa fa-check"></i><b>6.5.2</b> Discussion questions</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#r-assignment"><i class="fa fa-check"></i><b>6.6</b> R Assignment</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graphical-analysis-of-ordinary-differential-equations.html"><a href="graphical-analysis-of-ordinary-differential-equations.html"><i class="fa fa-check"></i><b>7</b> Graphical analysis of ordinary differential equations</a>
<ul>
<li class="chapter" data-level="7.1" data-path="graphical-analysis-of-ordinary-differential-equations.html"><a href="graphical-analysis-of-ordinary-differential-equations.html#building-nonlinear-odes"><i class="fa fa-check"></i><b>7.1</b> Building nonlinear ODEs</a></li>
<li class="chapter" data-level="7.2" data-path="graphical-analysis-of-ordinary-differential-equations.html"><a href="graphical-analysis-of-ordinary-differential-equations.html#qualitative-analysis-of-odes"><i class="fa fa-check"></i><b>7.2</b> Qualitative analysis of ODEs</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="graphical-analysis-of-ordinary-differential-equations.html"><a href="graphical-analysis-of-ordinary-differential-equations.html#graphical-analysis-of-the-defining-function"><i class="fa fa-check"></i><b>7.2.1</b> graphical analysis of the defining function</a></li>
<li class="chapter" data-level="7.2.2" data-path="graphical-analysis-of-ordinary-differential-equations.html"><a href="graphical-analysis-of-ordinary-differential-equations.html#fixed-points-and-stability"><i class="fa fa-check"></i><b>7.2.2</b> fixed points and stability</a></li>
<li class="chapter" data-level="7.2.3" data-path="graphical-analysis-of-ordinary-differential-equations.html"><a href="graphical-analysis-of-ordinary-differential-equations.html#outline-of-qualitative-analysis-of-an-ode"><i class="fa fa-check"></i><b>7.2.3</b> Outline of qualitative analysis of an ODE</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="graphical-analysis-of-ordinary-differential-equations.html"><a href="graphical-analysis-of-ordinary-differential-equations.html#functions-in-r"><i class="fa fa-check"></i><b>7.3</b> Functions in R</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="graphical-analysis-of-ordinary-differential-equations.html"><a href="graphical-analysis-of-ordinary-differential-equations.html#defining-a-function"><i class="fa fa-check"></i><b>7.3.1</b> defining a function</a></li>
<li class="chapter" data-level="7.3.2" data-path="graphical-analysis-of-ordinary-differential-equations.html"><a href="graphical-analysis-of-ordinary-differential-equations.html#calling-a-function"><i class="fa fa-check"></i><b>7.3.2</b> calling a function</a></li>
<li class="chapter" data-level="7.3.3" data-path="graphical-analysis-of-ordinary-differential-equations.html"><a href="graphical-analysis-of-ordinary-differential-equations.html#using-a-function-to-solve-a-difference-equation"><i class="fa fa-check"></i><b>7.3.3</b> using a function to solve a difference equation</a></li>
<li class="chapter" data-level="7.3.4" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#exercises"><i class="fa fa-check"></i><b>7.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="graphical-analysis-of-ordinary-differential-equations.html"><a href="graphical-analysis-of-ordinary-differential-equations.html#modeling-the-spread-of-infectious-disease-spread"><i class="fa fa-check"></i><b>7.4</b> Modeling the spread of infectious disease spread</a></li>
<li class="chapter" data-level="7.5" data-path="arithmetic-and-variables.html"><a href="arithmetic-and-variables.html#r-assignment"><i class="fa fa-check"></i><b>7.5</b> R Assignment</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="graphical-analysis-of-ordinary-differential-equations.html"><a href="graphical-analysis-of-ordinary-differential-equations.html#logistic-population-model"><i class="fa fa-check"></i><b>7.5.1</b> logistic population model</a></li>
<li class="chapter" data-level="7.5.2" data-path="graphical-analysis-of-ordinary-differential-equations.html"><a href="graphical-analysis-of-ordinary-differential-equations.html#sis-model-of-infectious-disease"><i class="fa fa-check"></i><b>7.5.2</b> SIS model of infectious disease</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>8</b> Introduction</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://dkon1.github.io/ql-book/" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantifying Life</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-ordinary-differential-equations" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Linear ordinary differential equations</h1>
<blockquote>
<p>He felt a restless, vague ambition<br />
A craving for a change of air<br />
(A most unfortunate condition,<br />
A cross not many choose to bear.)<br />
– Alexander Pushkin, <em>Eugene Onegin</em></p>
</blockquote>
<p>In the last chapter we considered discrete time models, in which time is counted in integers. This worked well to describe processes that happen in periodic cycles, like cell division or heart pumping. Many biological systems do not work this way. Change can happen continuously, that is, at any moment in time. For instance, the concentration of a biological molecule in the cell changes gradually, as does the voltage across the cell membrane in a neuron.</p>
<p>There are at least two good reasons to use differential equations for many applications. First, they are often more realistic than discrete time models, because some events happen very frequently and non-periodically. The second reason is mathematical: it turns out that dynamical systems with continuous time, described by differential equations, are better behaved than difference equations. This has to do with the essential “jumpiness” of difference equations. Even for simple nonlinear equations, the value of the variable after one time step can be far removed from its last value. This can lead to highly complicated solutions, as we saw in some of the numerical solutions in the last chapter. That kind of erratic behavior is impossible in one-variable differential equations (provided they have continuous defining functions.) In this chapter you will learn to do the following:</p>
<p>%The models for continuously changing variables require their own set of mathematical tools. Instead of difference equations, we are going to see our first differential equations, which use derivatives to describe how a variable changes with time. There is a tremendous amount of knowledge accumulated by mathematicians, physicists and engineers for analyzing and solving differential equations. There are many classes of differential equations for which it is possible to find analytic solutions, often in the form of so-called special functions. Differential equations courses for physicists and engineers are typically focused on learning about the variety of existing tools for solving a few types of differential equations. For the purposes of biological modeling, knowing how to solve a limited number of differential equations is of limited usefulness. We will instead focus on learning how to analyze the behavior of differential equations in general, without having to solve them on paper.</p>
<ul>
<li><p>build differential equations based on stated assumptions</p></li>
<li><p>find analytic solutions of linear differential equations</p></li>
<li><p>compute numerical solutions of differential equations using the Forward Euler method</p></li>
</ul>
<div id="building-differential-equations" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Building differential equations</h2>
<p></p>
<div id="from-discrete-time-to-continuous" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> from discrete time to continuous</h3>
<p>In this chapter we investigate  <em>continuous time dynamical systems</em>, for which it does not make sense to break time up into equal intervals. Instead of equations describing the increments in the dependent variable from one time step to the next, we will see equations with the instantaneous rate of the change (derivative) of the variable. Let us see the connection between the discrete and continuous dynamic models by reducing the step size of the bacteria-division population model.</p>
<p>First, suppose that instead of dividing every hour, the population of bacteria divide every half-hour, but only half of the population does. That half is chosen randomly, so we don’t have to keep track of whether each bacterium divided the last time around or not. Therefore, each half-hour exactly half of the population is added to the current population:
<span class="math display">\[ N(t+0.5) = N(t) + 0.5N(t) = 1.5N(t)\]</span>
The solution for this model can be figured out from the linear difference equation solution we derived in section  Every half-hour, the population is multiplied by 1.5, so we can write:
<span class="math display">\[ N(t) = 1.5^{2t} N(0) = (1.5^2)^t N(0)\]</span>
Compare this solution with the one for the every-hour model, <span class="math inline">\(N(t) = 2^t N(0)\)</span> by plugging in a few numbers for <span class="math inline">\(t\)</span>. The half-hour model grows faster, because it has the base of 2.25 instead of 2.</p>
<p>Now, suppose that the bacteria can divide four times an hour, but only a quarter of the population reproduces at any given time. The model can be written similarly:
<span class="math display">\[N(t+0.25) = N(t) + 0.25N(t) = 1.25N(t)\]</span>
The solution for this model is once again exponential, with the difference that each half contains 4 division events:
<span class="math display">\[N(t) = 1.25^{4t}N(0) = (1.25^4)^t N(0)\]</span>
This solution has the exponential base is <span class="math inline">\(1.25^4\)</span>, which is larger than <span class="math inline">\(1.5^2\)</span>. So what happens when we take this further?</p>
<p>Suppose the bacteria divide <span class="math inline">\(m\)</span> times an hour, with time step <span class="math inline">\(1/m\)</span>. Then extending our models above, we can write down the model and the solution:
<span class="math display">\[ N(t + 1/m) = N(t) + 1/m N(t) = (1+1/m) N(t) \]</span>
<span class="math display">\[ N(t) = (1+1/m)^{mt} N(0) = [(1+1/m)^m]^t N(0)\]</span></p>
<p>Now we can do what mathematicians enjoy the most: take things to the limit. What if <span class="math inline">\(m\)</span> were 100? A million? A gazillion? Let us re-write the model equation:
<span class="math display">\[ N(t+1/m) - N(t) = 1/m N(t) \Rightarrow \frac{N(t+1/m) - N(t) }{1/m} = N(t)\]</span></p>
<p>The expression on the left is known as Newton’s quotient that you encounter in the definition of a derivative. It measures the rate of change of the population <span class="math inline">\(N\)</span> from some time <span class="math inline">\(t\)</span> to the next time step <span class="math inline">\(t+1/m\)</span>. If <span class="math inline">\(m\)</span> is increased to make the time step smaller, this makes both the numerator and the denominator smaller, and the quotient approaches the <em>instantaneous rate of change</em> of <span class="math inline">\(N(t)\)</span>. So, if bacteria divide at any point in time, with the , the model becomes a differential equation:
<span class="math display">\[ \frac{dN}{dt} = N(t)\]</span></p>
<p>We can do a similar procedure to the formula of the solution of the model. The dependence on <span class="math inline">\(m\)</span> is all on the left-hand side, in the expression <span class="math inline">\((1+1/m)^m\)</span>, which is the base of the exponential function. What happens to this number as <span class="math inline">\(m\)</span> becomes larger? Does it increase without bound? You can investigate this numerically by plugging in progressively larger numbers <span class="math inline">\(m\)</span>, and see that the number approaches a specific value: 2.71828… This is the special constant <span class="math inline">\(e\)</span>, called the base of the natural logarithm. So, if bacteria divide at any point in time, with the <strong>average rate of 1 per hour</strong>, the solution of the model becomes:
<span class="math display">\[ N(t) = e^t N(0)\]</span></p>
</div>
<div id="exercises" class="section level3" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Exercises</h3>
<p>Here we will explore the effect of changing the step size on the solution of a discrete time dynamic model. We will use a very simple model of bacterial population growth, in which we assume that bacteria divide once an hour and there are no deaths.</p>
<ol style="list-style-type: decimal">
<li>Calculate the solution for this population, assuming that all bacteria divide exactly once an hour - in other words, a birth rate of one per individual. Starting with one bacterium use a for loop to calculate the solution for 10 hours and print out the last value.</li>
</ol>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="linear-ordinary-differential-equations.html#cb192-1" aria-hidden="true"></a><span class="co"># YOUR CODE HERE</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Suppose that these bacteria can divide twice an hour, but only half of the population divides each time - in other words, a per capita birth rate of 0.5 per half an hour. Change your model so it calculates a solution vector with the time step of 30 minutes over 10 hours, print out the number of bacteria after 10 hours and compare it with the previous value.</li>
</ol>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="linear-ordinary-differential-equations.html#cb193-1" aria-hidden="true"></a><span class="co"># YOUR CODE HERE</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Suppose that these bacteria divide every 15 minutes, but only one quarter of the population divides each time - in other words, a per capita birth rate of 0.25 per quarter hour. Change your model so it calculates a solution vector with the time step of 15 minutes over 10 hours, print out the number of bacteria after 10 hours and compare it with the previous value.</li>
</ol>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="linear-ordinary-differential-equations.html#cb194-1" aria-hidden="true"></a><span class="co"># YOUR CODE HERE</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Suppose that these bacteria divide every 1 minute, but only 1/60 of the population divides each time - in other words, a per capita birth rate of 1/60 per minute. Change your model so it calculates a solution vector with the time step of 1 minute over 10 hours, print out the number of bacteria after 10 hours and compare it with the previous value.</li>
</ol>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="linear-ordinary-differential-equations.html#cb195-1" aria-hidden="true"></a><span class="co"># YOUR CODE HERE</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Suppose that these bacteria divide every second, but only 1/3600 of the population divides each time - in other words, a per capita birth rate of 1/3600 per second. Change your model so it calculates a solution vector with the time step of 1 second over 10 hours, print out the number of bacteria after 10 hours and compare it with the previous value.</li>
</ol>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="linear-ordinary-differential-equations.html#cb196-1" aria-hidden="true"></a><span class="co"># YOUR CODE HERE</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Produce a plot of the five solutions of bacterial population dividing with different time steps. Take the five code chunks from above, and copy them all into the chunk below. For each calculation add a time vector that corresponds to each time step (e.g. one for every hour for the first one, one for every second for the last one) and make a plot of each of the solutions as function of time on the same plot - use plot() for the first one and lines() for all the rest, with different colors and add a legend indicating different time steps.</li>
</ol>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="linear-ordinary-differential-equations.html#cb197-1" aria-hidden="true"></a><span class="co"># YOUR CODE HERE</span></span></code></pre></div>
<p>What behaviors do you see for the solutions with different time steps? What effect does shrinking the time step have on the solution? What do you expect would happen if the time step were a millisecond, or a microsecond?</p>
</div>
<div id="growth-proportional-to-population-size" class="section level3" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> growth proportional to population size</h3>
<p>We will now build some common differential equations models. First, a simple population growth model with a constant growth rate. Suppose that in a population each individual reproduces with the average reproductive rate <span class="math inline">\(r\)</span>. This is reflected in the following differential equation:
<span class="math display">\[\begin{equation}
\frac{d x} {dt} = \dot x = r x
\label{eq:linear_ode}
 \end{equation}\]</span>
This expression states that the rate of change of <span class="math inline">\(x\)</span>, which we take to be population size, is proportional to <span class="math inline">\(x\)</span> with multiplicative constant <span class="math inline">\(r\)</span>. We will sometimes use the notation <span class="math inline">\(\dot x\)</span> for the time derivative of <span class="math inline">\(x\)</span> (which was invented by Newton) for aesthetic reasons.</p>
<p>First, we apply  dimensional analysis to this model. The units of the derivative are population per time, as can be deduced from the Newton’s quotient definition. Thus, the units in the equation have the following relationship:
<span class="math display">\[ \frac{[population]}{[time]} = [r] [population] = \frac{1}{[time]}[population] \]</span>
This shows that as in the discrete time models, the dimension of the population growth rate <span class="math inline">\(r\)</span> is inverse time, or frequency. The difference with the discrete time population models lies in the time scope of the rate. In the case of the difference equation, <span class="math inline">\(r\)</span> is the rate of change per one time step of the model. In the differential equation, <span class="math inline">\(r\)</span> is the <em>instantaneous rate of population growth</em>. It is less intuitive than the growth rate per single reproductive cycle, just like the slope of a curve is less intuitive than the slope of a line. The population growth happens continuously, so the growth rate of <span class="math inline">\(r\)</span> individuals per year does not mean that if we start with one individual, there will be <span class="math inline">\(r\)</span> after one year. In order to make quantitative predictions, we need to find the solution of the equation, which we will see in the next section.</p>
</div>
<div id="chemical-kinetics" class="section level3" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> chemical kinetics</h3>
<p>Reactions between molecules in cells occur continuously, driven by molecular collisions and physical forces. In order to model this complex behavior, it is generally assumed that reactions occur with a particular speed, known as the  <em>kinetic rate constant</em>. As mentioned in chapter 2, a simple reaction of conversion from one type of molecule (<span class="math inline">\(A\)</span>) to another (<span class="math inline">\(B\)</span>) can be written as follows:
<span class="math display">\[ A \xrightarrow{k} B \]</span>
In this equation the parameter <span class="math inline">\(k\)</span> is the kinetic rate rate constant, describing the speed of conversion of <span class="math inline">\(A\)</span> into <span class="math inline">\(B\)</span>, per concentration of <span class="math inline">\(A\)</span>.</p>
<p>Chemists and biochemists use differential equations to describe the change in molecular concentration during a reaction. These equations are known as the  <em>laws of mass action</em>. For the reaction above, the concentration of molecule <span class="math inline">\(A\)</span> decreases continuously proportionally to itself, and the concentration of molecule <span class="math inline">\(B\)</span> increases continuously proportionally to the concentration of <span class="math inline">\(A\)</span>. This is expressed by the following two differential equations:
<span class="math display">\[\begin{eqnarray}
\label{eq:lin_chem_kin}
\dot A &amp;=&amp; - k A \\
\dot B &amp;=&amp; kA
\end{eqnarray}\]</span></p>
<p>Several conclusions are apparent by inspection of the equations. First, the dynamics depend only on the concentration of <span class="math inline">\(A\)</span>, so keeping track of the concentration of <span class="math inline">\(B\)</span> is superfluous. The second observation reinforces the first: the sum of the concentrations of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> is constant. This is mathematically demonstrated by adding the two equations together to obtain the following:
<span class="math display">\[ \dot A + \dot B = -kA + kA = 0\]</span>
One of the basic properties of the derivative is that the sum of derivatives is the same as the derivative of the sum:
<span class="math display">\[\dot A + \dot B = \frac{d(A+B)}{dt} = 0\]</span></p>
<p>This means that the sum of the concentrations of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> is a constant. This is a mathematical expression of the law of conservation in chemistry: molecules can change from one type to another, but they cannot appear or disappear in other ways. In this case, a single molecule of <span class="math inline">\(A\)</span> becomes a single molecule of <span class="math inline">\(B\)</span>, so it follows that the sum of the two has to remain the same. If the reaction were instead two molecules of <span class="math inline">\(A\)</span> converting to a molecule of <span class="math inline">\(B\)</span>, then the conserved quantity is <span class="math inline">\(2A + B\)</span>. The concept of conserved quantity is very useful for the analysis of differential equations. We will see in later chapters how it can help us find solutions, and explain the behavior of complex dynamical systems.</p>
</div>
</div>
<div id="solutions-of-ordinary-differential-equations" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Solutions of ordinary differential equations</h2>
<p></p>
<p>In this section we will investigate how to write down analytic solutions for ordinary differential equations (ODEs). Let us first define the mathematical terms that will be used in this discussion.</p>

<div class="definition">
<span id="def:def-ode" class="definition"><strong>Definition 6.1  </strong></span>An ordinary differential equation is an equation that contains derivatives of the  dependent variable (e.g. <span class="math inline">\(x\)</span>) with respect to an independent variable (e.g. <span class="math inline">\(t\)</span>). For example:
<span class="math display">\[ \frac{dx^2}{dt^2}+ 0.2 \frac{dx}{dt} - 25 = 0 \]</span>
</div>
For the time being, we will restrict ourselves to ODEs with the highest derivative being of first order, called <em>first-order</em> ODEs. Second-order ODEs are common in models derived from physics, but can actually be converted to first-order ODEs, though it requires an additional dependent variable. Third and higher order ODEs are very uncommon. To be precise:

<div class="definition">
<span id="def:def-firstode" class="definition"><strong>Definition 6.2  </strong></span>A  ODE is one where the derivative <span class="math inline">\(dx/dt\)</span> is equal to a <em>defining function</em> <span class="math inline">\(f(x,t)\)</span>, like this:
<span class="math display">\[\frac{dx} {dt} = \dot x = f(x,t)\]</span>
</div>
<p>The defining function may potentially depend on both the dependent variable <span class="math inline">\(x\)</span> and the  independent variable <span class="math inline">\(t\)</span>. If it only depends on <span class="math inline">\(x\)</span>, it is called an <em>autonomous</em> ODE, for example:</p>
<p><span class="math display">\[ \frac{dx}{dt} = \dot x = rx \]</span>
or</p>
<p><span class="math display">\[\frac{dx}{dt} = \dot x = 5x -4\]</span></p>
<p>On the other hand, if the defining function depends only on the independent variable <span class="math inline">\(t\)</span>, it may be called a <em>pure-time</em> ODE, for example:</p>
<p><span class="math display">\[ 
\frac{dx}{dt} = \dot x = 5t
\]</span>
or</p>
<p><span class="math display">\[
\frac{dx}{dt} = \dot x = 20 - 0.3 \sin(4 \pi t)
\]</span></p>
<p>An ODE is  if every term involves either the dependent variable <span class="math inline">\(x\)</span> or its derivative.
\end{mosdef}
For instance, <span class="math inline">\(\dot x = x^2 + \sin(x)\)</span> is homogeneous, while <span class="math inline">\(\dot x = -x + 5t\)</span> is not.</p>
<p>Most simple biological models that we will encounter in the next two chapters are autonomous, homogeneous ODEs. However, inhomogeneous equations are important in many applications, and we will encounter them at the end of the present section.</p>
<div id="separate-and-integrate-method" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> separate and integrate method</h3>
<p>The   is a function of the independent variable that satisfies the equation for a range of values of the independent variable. In contrast with algebraic equations, we cannot simply isolate <span class="math inline">\(x\)</span> on one side of the equal sign and find the solutions as one, or a few numbers. Instead, solving ordinary differential equations is very tricky, and no general strategy for solving an arbitrary ODE exists. Moreover, a solution for an ODE is not guaranteed to exist at all, or not for all values of <span class="math inline">\(t\)</span>. We will discuss some of the difficulties later, but let us start with equations that we can solve.</p>
<p>The most obvious strategy for solving an ODE is integration. Since a differential equation contains derivatives, integrating it can remove the derivative. In the case of the general first order equation, we can integrate both sides to obtain the following:
<span class="math display">\[ \int \frac{dx}{dt} dt = \int f(x,t) dt \Rightarrow x + C = \int f(x,t) dt\]</span>
The constant of integration <span class="math inline">\(C\)</span> appears as in the standard anti-derivative definition. It can be specified by an initial condition for the solution <span class="math inline">\(x(t)\)</span>.</p>
<p>The simplest method of analytic solution of a first-order ODEs, which I call  <em>separate-and-integrate</em> consists of the following steps:</p>
<ol style="list-style-type: decimal">
<li>use algebra to place the dependent and independent variables on different sides of the equations, including the differentials (e.g. <span class="math inline">\(dx\)</span> and <span class="math inline">\(dt\)</span>)</li>
<li>integrate both sides with respect to the different variables, don’t forget the integration constant</li>
<li>solve for the dependent variable (e.g. <span class="math inline">\(x\)</span>)</li>
<li>plug in <span class="math inline">\(t=0\)</span> and use the initial value <span class="math inline">\(x(0)\)</span> to solve for the integration constant</li>
</ol>
<p><strong>Example.</strong> Consider a very simple differential equation: <span class="math inline">\(\dot x = a\)</span>, where <span class="math inline">\(\dot x\)</span> stands for the time derivative of the dependent variable <span class="math inline">\(x\)</span>, and <span class="math inline">\(a\)</span> is a constant. It can be solved by integration:
<span class="math display">\[ \int \frac{dx}{dt} dt  = \int a dt  \Rightarrow x(t) + C = at \]</span></p>
<p>This solution contains an undetermined integration constant; if an initial condition is specified, we can determine the complete solution. Generally speaking, if the initial condition is <span class="math inline">\(x(0) = x_0\)</span>, we need to solve an algebraic equation to determine <span class="math inline">\(C\)</span>: <span class="math inline">\(x_0 = a*0 - C\)</span>, which results in <span class="math inline">\(C = -x_0\)</span>. The complete solution is then <span class="math inline">\(x(t) = at + x_0\)</span>. To make the example more specific, if <span class="math inline">\(a = 5\)</span> and the initial condition is <span class="math inline">\(x(0) = -3\)</span>, the solution is</p>
<p><span class="math display">\[x(t) = 5t -3\]</span></p>
<p><strong>Example.</strong> Let us solve the linear population growth model in equation : <span class="math inline">\(\dot x = rx\)</span>. The equation can be solved by first dividing both sides by <span class="math inline">\(x\)</span> and then integrating: 
<span class="math display">\[ \int \frac{1}{x} \frac{d x}{dt}  dt = \int \frac{dx}{x} = \int r dt \Longrightarrow \log |x| = rt + C  \Longrightarrow  x =  e^{rt+C} = Ae^{rt}\]</span></p>
<p>We used basic algebra to solve for <span class="math inline">\(x\)</span>, exponentiating both sides to get rid of the logarithm on the left side. As a result, the additive constant <span class="math inline">\(C\)</span> gave rise to the multiplicative constant <span class="math inline">\(A=e^C\)</span>. Once again, the solution contains a constant which can be determined by specifying an initial condition <span class="math inline">\(x(0) = x_0\)</span>. In this case, the relationship is quite straightforward: <span class="math inline">\(x(0) = A e^0 = A\)</span>. Thus, the complete solution for equation  is:
<span class="math display">\[ x(t) = x_0e^{rt}\]</span></p>
</div>
<div id="behavior-of-solutions-of-linear-odes" class="section level3" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> behavior of solutions of linear ODEs</h3>
<p>As in the case of the discrete-time models, population growth with a constant birth rate has  exponential form. Once again, please pause and consider this fact, because the exponential solution of linear equations is one of the most basic and powerful tools in applied mathematics. Immediately, it allows us to classify the behavior of linear ODE into three categories:</p>
<ul>
<li><span class="math inline">\(r &gt; 0\)</span>: <span class="math inline">\(x(t)\)</span> grows without bound</li>
<li><span class="math inline">\(r &lt; 0\)</span>: <span class="math inline">\(x(t)\)</span> decays to 0</li>
<li><span class="math inline">\(r = 0\)</span>: <span class="math inline">\(x(t)\)</span> remains constant at the initial value</li>
</ul>
<p>The rate <span class="math inline">\(r\)</span> being positive reflects the dominance of birth rate over death rate in the population, leading to unlimited population growth. If the death rate is greater, the population will decline and die out. If the two are exactly matched, the population size will remain unchanged.</p>
<p><strong>Example.</strong> The solution for the biochemical kinetic model in equation  is identical except for the sign: <span class="math inline">\(A(t) = A_0 e^{-kt}\)</span>. When the reaction rate <span class="math inline">\(k\)</span> is positive, as it is in chemistry, the concentration of <span class="math inline">\(A\)</span> decays to 0 over time. This should be obvious from our model, since there is no back reaction, and the only chemical process is conversion of <span class="math inline">\(A\)</span> into <span class="math inline">\(B\)</span>. The concentration of <span class="math inline">\(B\)</span> can be found by using the fact that the total concentration of molecules in the model is conserved. Let us call it <span class="math inline">\(C\)</span>. Then <span class="math inline">\(B(t) = C - A(t) = C- A_0e^{-kt}\)</span>. The concentration of <span class="math inline">\(B\)</span> increases to the asymptotic limit of <span class="math inline">\(C\)</span>, meaning that all molecules of <span class="math inline">\(A\)</span> have been converted to <span class="math inline">\(B\)</span>.</p>
</div>
<div id="solutions-of-inhomogeneous-odes" class="section level3" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> solutions of inhomogeneous ODEs</h3>
<p>The two models we have seen above are non-homogeneous, because they involve a term without a dependent variable, and linear, because the relationship with the dependent variable term is proportional. They can be solved on paper using the same separate-and-integrate method, modified slightly to handle the constant term. Here are the steps to solve the generic linear ODE with a constant term <span class="math inline">\(\dot x = ax +b\)</span>:</p>
<ol style="list-style-type: decimal">
<li>separate the dependent and independent variables on different sides of the equations, by dividing both sides by the right hand side <span class="math inline">\(ax+b\)</span>, and multiplying both sides by the differential <span class="math inline">\(dt\)</span></li>
<li>integrate both sides with respect to the different variables, don’t forget the integration constant!</li>
<li>solve for the dependent variable (e.g. <span class="math inline">\(x\)</span>)</li>
<li>plug in <span class="math inline">\(t=0\)</span> and use the initial value <span class="math inline">\(x(0)\)</span> to solve for the integration constant</li>
</ol>
<p><strong>Example.</strong> Let us solve the following ODE model using separate and integrate with the given initial value:
<span class="math display">\[\frac{dx}{dt} = 4x -100;  \; x(0) = 32 \]</span></p>
<ol style="list-style-type: decimal">
<li><p>separate the dependent and independent variables:
<span class="math display">\[ \frac{dx}{4x - 100} = dt\]</span></p></li>
<li><p>integrate both sides:
<span class="math display">\[  \int \frac{dx}{4x -100} =  \int dt \Rightarrow \frac{1}{4} \int \frac{du}{u} = \frac{1}{4} \ln | 4x- 100 |  = t + C\]</span>
The integration used the substitution of the new variable <span class="math inline">\(u=4x -100\)</span>, with the concurrent substitution of <span class="math inline">\(dx = du/4\)</span>.</p></li>
<li><p>solve for the dependent variable:
<span class="math display">\[  \ln | 4x- 100 |  = 4t + C \Rightarrow 4x-100 = e^{4t} B  \Rightarrow x = 25  + Be^{4t}\]</span>
Here the first step was to multiply both sides by 4, and the second to use both sides as the exponents of <span class="math inline">\(e\)</span>, removing the natural log from the left hand side, and finally simple algebra to solve for <span class="math inline">\(x\)</span> as a function of <span class="math inline">\(t\)</span>.</p></li>
<li><p>solve for the integration constant:
<span class="math display">\[ x(0) = 25  + B = 32 \Rightarrow B = 7\]</span>
Here the exponential ``disappeared’’ because <span class="math inline">\(e^0=1\)</span>.
\end{enumerate}
Therefore, the complete solution of the ODE with the given initial value is
<span class="math display">\[x(t) =  25  + 5e^{4t}\]</span></p></li>
</ol>
<p>At this point, you might have noticed something about solutions of linear ODEs: they always involve an exponential term, with time in the exponent. Knowing this, it is possible to bypass the whole process of separate-and-integrate by using the following short-cut.</p>
<p><strong>Important fact:</strong> Any linear ODE of the form $x= ax +b $ has an analytic solution of the form:
<span class="math display">\[ x(t) = Ce^{at} + D\]</span></p>
<p>This can be tested by plugging the solution back into the ODE to see if it satisfies the equation. First, take the derivative of the solution to get the left-hand side of the ODE: <span class="math inline">\(\frac{dx}{dt} = Ca e^{at}\)</span>; the plug in <span class="math inline">\(x(t)\)</span> into the right hand side of the ODE: <span class="math inline">\(aCe^{at} + aD +b\)</span>. Setting the two sides equal, we get:
<span class="math display">\[Ca e^{at} = aCe^{at} + aD +b\]</span>
which is satisfied if <span class="math inline">\(aD + b = 0\)</span>, which means <span class="math inline">\(D= -b/a\)</span>. This is consistent with the example above, the additive constant in the solution was 0.8, which is <span class="math inline">\(-b/a= -(4)/5=0.8\)</span>.</p>
<p>In short, if you want to solve a linear ODE <span class="math inline">\(\dot x= ax +b\)</span> , you can bypass the separate-and-integrate process, because the general solution always has the form:
<span class="math display">\[\begin{equation}
x(t) = Ce^{at} - \frac{b}{a}
\label{eq:ch15_ode_sol}
\end{equation}\]</span></p>
<p>The unknown constant <span class="math inline">\(C\)</span> can be determined from a given initial value. So the upshot is that all linear ODEs have solutions which are exponential in time with exponential constant coming from the slope constant <span class="math inline">\(a\)</span> in the ODE. The dynamics of the solution are determined by the sign of the constant <span class="math inline">\(a\)</span>: if <span class="math inline">\(a&gt;0\)</span>, the solution grows (or declines) without bound; and if <span class="math inline">\(a&lt;0\)</span>, the solution approaches an asymptote at <span class="math inline">\(-b/a\)</span> (from above or below, depending on the initial value). Go back and read section  for a review of exponential functions if this is not clear.</p>
</div>
<div id="exercises-1" class="section level3" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Exercises</h3>
<p>Solve the following linear ODEs and use the specified initial values to determine the integration constant. Describe how the solution behaves over a long time (e.g. grows without bound, goes to zero, etc.). Plug the solution back into the ODE to check that it satisfies the equation.</p>
<ol style="list-style-type: decimal">
<li><p><span class="math display">\[ \frac{dx}{dt} = 0.1; \; x(0)= 100 \]</span></p></li>
<li><p><span class="math display">\[ \frac{dx}{dt} =  2\sin(4t) -0.4t; \; x(0)= 5 \]</span></p></li>
<li><p><span class="math display">\[ \frac{dx}{dt} = 3x; \; x(0) = 0.4 \]</span></p></li>
<li><p><span class="math display">\[ \frac{dx}{dt} = -5x; \;  x(0) = -300 \]</span></p></li>
<li><p><span class="math display">\[ \frac{dx}{dt} = -0.5x + 100 ; \; x(0) = 20 \]</span></p></li>
<li><p><span class="math display">\[ \frac{dx}{dt} =  1 + x; \; x(0) = 4 \]</span></p></li>
<li><p><span class="math display">\[ \frac{dx}{dt} =  -10 - 0.2x; \; x(0) = 10 \]</span></p></li>
<li><p><span class="math display">\[ \frac{dx}{dt} =  -4 + 0.5x; \; x(0) = 6 \]</span></p></li>
</ol>
</div>
</div>
<div id="numeric-solutions-and-the-forward-euler-method" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Numeric solutions and the Forward Euler method</h2>
<p>Analytic solutions are very useful for a modeler because they allow prediction of the variable of interest at any time in the future. However, for many differential equations they are not easy to find, and for many others they simply cannot be written down in a symbolic form. Instead, one can use a numerical approach, which does not require an exact formula for the solution. The idea is to start at a given initial value (e.g. <span class="math inline">\(x(0)\)</span>) and use the derivative from the ODE (e.g. <span class="math inline">\(dx/dt\)</span>) as the rate of change of the solution (e.g. <span class="math inline">\(x(t)\)</span>) to calculate the change or increment for the solution over a time step. Essentially, this means replacing the continuous change of the derivative with a discrete time step, thus converting the differential equation into a difference equation and then solving it. The solution of the difference equation is not the same as the solution of the ODE, so  <em>numeric solutions</em> of ODEs are always approximate. I will use the letter <span class="math inline">\(y(t)\)</span> to denote the numerical solution to distinguish it from the exact solution <span class="math inline">\(x(t)\)</span>. The fundamental difference between them is that <span class="math inline">\(y(t)\)</span> is not a formula that can be evaluated at any point in time, but instead is a sequence of numbers calculated every time step, which hopefully are close to the exact solution <span class="math inline">\(x(t)\)</span>.</p>
<p>Let us introduce all the players: first, we need to pick the time step <span class="math inline">\(\Delta t\)</span>, which is the length of time between successive values of <span class="math inline">\(y\)</span>. In the difference equation notation one can use <span class="math inline">\(y_i\)</span> to mean <span class="math inline">\(y(i\Delta t)\)</span>, the value of the numerical solution after <span class="math inline">\(i\)</span> time steps. Then we need to calculate the derivative, or the rate of change at a particular point in time. For any first-order ODE of the form
<span class="math display">\[ \frac{d x} {dt} = \dot x = f(x,t)\]</span></p>
<p>the rate of change depends (potentially) on the values of <span class="math inline">\(x\)</span> and <span class="math inline">\(t\)</span>. This rate of change based on the numerical solution after <span class="math inline">\(i\)</span> time steps is <span class="math inline">\(f(y(i\Delta t), i\Delta t) = f(y_i, t_i)\)</span>. Finally, to calculate the change of the dependent variable we need to multiply the rate of change by the time step. This should make sense in a practical context: if you drive for two hours (time step) at 60 miles per hour (rate of change), the total distance (increment) is <span class="math inline">\(2*60=120\)</span> miles. By the same token, we can write down how to calculate the next value of the numerical solution <span class="math inline">\(y_{i+1}\)</span> based on the previous one:
<span class="math display">\[\begin{equation}
 y_{i+1} = y_i + \Delta t f(y_i, t_i) 
 \label{eq:ch15_FE}
\end{equation}\]</span></p>
<p>This method of computing a numerical solution of an ODE is called the  <em>Forward Euler method</em>, after the famous mathematician who first came up with it. It is called a forward method because it uses the value of the dependent variable and its derivative at time step <span class="math inline">\(i\)</span> to predict the value at the next time step <span class="math inline">\(i+1\)</span>. The method is iterative, so it needs to be repeated in order to calculate a set of values of the approximate solution <span class="math inline">\(y(t)\)</span>. Here are a couple of simple examples of computing numerical solution using FE:</p>
<p> Let us numerically solve the ODE <span class="math inline">\(\dot x = -0.1\)</span> using the Forward Euler method. This means the defining function in the formulation of FE above is <span class="math inline">\(f(x,t)=-0.1\)</span>. We can calculate the numeric solution for a couple of steps and compare the values with the exact solution, since we now know that it is <span class="math inline">\(x(t) = x_0 -0.1t\)</span>. Let us pick the time step <span class="math inline">\(\Delta t = 0.2\)</span> and begin with the initial value <span class="math inline">\(x(0)=1\)</span>. Here are the first three steps using the FE method:
<span class="math display">\[ y(0.2) = y(0) + \Delta t f(y(0)) = 1 + 0.2*(-0.1) = 0.98\]</span>
<span class="math display">\[ y(0.4) = y(0.2) + \Delta t f(y(0.2)) = 0.98+ 0.2*(-0.1) = 0.96\]</span>
<span class="math display">\[ y(0.6) = y(0.4) + \Delta t f(y(0.4)) = 0.96+ 0.2*(-0.1) = 0.94\]</span>
Since the rate of change in this ODE is constant, the solution declines by the same amount every time step. In this case, the numerical solution is actually exact, and perfectly matches the analytic solution. Table  (right) shows the numerical solution for 3 time steps along with the exact solution.</p>
<p> Let us numerically solve the ODE <span class="math inline">\(\dot x = -0.1x\)</span> using the Forward Euler method. This means the defining function in the formulation of FE above is <span class="math inline">\(f(x,t)=-0.1x\)</span>. We can calculate the numeric solution for a couple of steps and compare the values with the exact solution, since we now know that it is <span class="math inline">\(x(t) = x_0 e^{-0.1t}\)</span>. Let us pick the time step <span class="math inline">\(\Delta t = 0.2\)</span> and begin with the initial value <span class="math inline">\(x(0)=100\)</span>. Here are the first three steps using the FE method:
<span class="math display">\[ y(0.2) = y(0) + \Delta t f(y(0)) = 100 + 0.2*(-0.1*100) = 98\]</span>
<span class="math display">\[ y(0.4) = y(0.2) + \Delta t f(y(0.2)) = 98+ 0.2*(-0.1*98) \]</span>
<span class="math display">\[ = 96.04\]</span>
<span class="math display">\[ y(0.6) = y(0.4) + \Delta t f(y(0.4)) = 96.04+ 0.2*(-0.1*96.04) \approx  \]</span>
<span class="math display">\[ \approx 94.12\]</span>
In this case, the derivative is not constant and the numerical solution is not exact, which is demonstrated in table  (left). The error in the numerical solution grows with time, which may be problematic. We will further investigate how to implement the computation of numerical solutions using R in the next section.</p>
<table>
<caption>Numerical solutions of the ODE <span class="math inline">\(\dot x = -0.1\)</span> using Forward Euler <span class="math inline">\(y\)</span> calculated for 3 steps of size <span class="math inline">\(\Delta t = 0.2\)</span> as well as the exact solution <span class="math inline">\(x\)</span>, both rounded to two digits after the decimal, and the error of the numerical solution.</caption>
<thead>
<tr class="header">
<th align="center">t</th>
<th align="center">x</th>
<th align="center">y</th>
<th align="right">error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="center">0.2</td>
<td align="center">0.98</td>
<td align="center">0.98</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="center">0.4</td>
<td align="center">0.96</td>
<td align="center">0.96</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="center">0.6</td>
<td align="center">0.94</td>
<td align="center">0.94</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<table>
<caption>Numerical solution of the ODEs <span class="math inline">\(\dot x = -0.1x\)</span> (right) using Forward Euler <span class="math inline">\(y\)</span> calculated for 3 steps of size <span class="math inline">\(\Delta t = 0.2\)</span> as well as the exact solution <span class="math inline">\(x\)</span>, both rounded to two digits after the decimal, and the error of the numerical solution.</caption>
<thead>
<tr class="header">
<th align="center">t</th>
<th align="center">x</th>
<th align="center">y</th>
<th align="left">error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">100</td>
<td align="center">100</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="center">0.2</td>
<td align="center">98.02</td>
<td align="center">98</td>
<td align="left">0.02</td>
</tr>
<tr class="odd">
<td align="center">0.4</td>
<td align="center">96.08</td>
<td align="center">96.04</td>
<td align="left">0.04</td>
</tr>
<tr class="even">
<td align="center">0.6</td>
<td align="center">94.18</td>
<td align="center">94.12</td>
<td align="left">0.06</td>
</tr>
</tbody>
</table>
<p></p>
<div id="exercises-2" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Exercises</h3>
<p>Use the Forward Euler method to solve the following differential equations with time step <span class="math inline">\(\Delta t=0.5\)</span> for 2 steps to compute <span class="math inline">\(y(1)\)</span> (the value of the numerical solution at <span class="math inline">\(t=1\)</span>.)</p>
<ol style="list-style-type: decimal">
<li><p><span class="math display">\[ \frac{dx}{dt} = 0.1; \; x(0)= 100 \]</span></p></li>
<li><p><span class="math display">\[ \frac{dx}{dt} =  2\sin(4t) -0.4t; \; x(0)= 5 \]</span></p></li>
<li><p><span class="math display">\[ \frac{dx}{dt} = 3x; \; x(0) = 0.4 \]</span></p></li>
<li><p><span class="math display">\[ \frac{dx}{dt} = -5x; \;  x(0) = -300 \]</span></p></li>
<li><p><span class="math display">\[ \frac{dx}{dt} = -0.5x + 100 ; \; x(0) = 20 \]</span></p></li>
<li><p><span class="math display">\[ \frac{dx}{dt} =  1 + x; \; x(0) = 4 \]</span></p></li>
<li><p><span class="math display">\[ \frac{dx}{dt} =  -10 - 0.2x; \; x(0) = 10 \]</span></p></li>
<li><p><span class="math display">\[ \frac{dx}{dt} =  -4 + 0.5x; \; x(0) = 6 \]</span></p></li>
</ol>
</div>
</div>
<div id="forward-euler-method-in-r" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Forward Euler method in R</h2>
<p></p>
<div id="implementation" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> implementation</h3>
<p>In practice, the most common approach to finding solutions for differential equations is using a computer to calculate a numerical solution, for example using the Forward Euler method. This means using a computer program to construct a sequence of values of the dependent variable that approximate the true solution. Below is an outline of the algorithm that can be translated into a programming language, like R, to solve ODEs.</p>
<ul>
<li><p>assign the time step <code>dt</code>, length of time <code>Tmax</code>, number of time steps <code>numstep</code></p></li>
<li><p>pre-allocate the vector of numeric solution values <code>y</code> of length <code>numstep+1</code></p></li>
<li><p>assign the initial value for the ODE to the first element of the solution</p></li>
<li><p>assign the vector of time values <code>t</code> from 0 to <code>Tmax</code> of length <code>numstep+1</code></p></li>
<li><p>for loop starting at 1 to <code>numstep</code></p>
<ul>
<li>assign the next solution value to be the current solution value plus the time step multiplied by the defining function at the current solution value</li>
</ul></li>
<li><p>plot numeric solution <code>y</code> as a function of time <code>t</code></p></li>
</ul>
<p>To implement the algorithm, one need to know the defining function <span class="math inline">\(f(x,t)\)</span>, the initial value, the time step, and the total time. The output is the solution vector <span class="math inline">\(y\)</span>, which contains a sequence of values that approximate the solution of the ODE, along with the vector of time values spaced by the time step. Below is an example implementation of the Forward Euler method for the following linear ODE with initial value 1000:</p>
<p><span class="math display">\[ 
\frac{dx}{dt} =  -0.5 x 
\]</span></p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="linear-ordinary-differential-equations.html#cb198-1" aria-hidden="true"></a>x0 &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb198-2"><a href="linear-ordinary-differential-equations.html#cb198-2" aria-hidden="true"></a>dt &lt;-<span class="st"> </span><span class="fl">0.01</span> <span class="co"># set time step</span></span>
<span id="cb198-3"><a href="linear-ordinary-differential-equations.html#cb198-3" aria-hidden="true"></a>Tmax &lt;-<span class="st"> </span><span class="dv">10</span> <span class="co"># set length of time</span></span>
<span id="cb198-4"><a href="linear-ordinary-differential-equations.html#cb198-4" aria-hidden="true"></a>numstep &lt;-<span class="st"> </span>Tmax<span class="op">/</span>dt <span class="co"># assign number of time steps</span></span>
<span id="cb198-5"><a href="linear-ordinary-differential-equations.html#cb198-5" aria-hidden="true"></a>pop &lt;-<span class="st"> </span><span class="kw">rep</span>(x0, numstep<span class="op">+</span><span class="dv">1</span>) <span class="co"># initialize solution with y0</span></span>
<span id="cb198-6"><a href="linear-ordinary-differential-equations.html#cb198-6" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>numstep) { <span class="co"># do the Euler!</span></span>
<span id="cb198-7"><a href="linear-ordinary-differential-equations.html#cb198-7" aria-hidden="true"></a>	pop[i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>pop[i]<span class="op">+</span>dt<span class="op">*</span>(<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>pop[i])</span>
<span id="cb198-8"><a href="linear-ordinary-differential-equations.html#cb198-8" aria-hidden="true"></a>}</span>
<span id="cb198-9"><a href="linear-ordinary-differential-equations.html#cb198-9" aria-hidden="true"></a>time &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,Tmax, dt)</span>
<span id="cb198-10"><a href="linear-ordinary-differential-equations.html#cb198-10" aria-hidden="true"></a><span class="kw">plot</span>(time, pop, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="QuantLife_files/figure-html/fig-FE-sol-1.png" width="672" /></p>
<p>Notice that it is very similar to the script for numerical solution of a difference equation we saw in  with the major difference being the presence of a time step, whereas in difference equations the time step is always 1. There is one more important point for the implementation: usually one needs to solve the ODE for a particular length of time <span class="math inline">\(T\)</span> with a specified time step <span class="math inline">\(\Delta t\)</span> . This dictates that the required number of iterations be <span class="math inline">\(T/\Delta t\)</span>; in other words, for a given time period the number of time steps is inversely proportional to the time step.</p>
</div>
<div id="exercises-3" class="section level3" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Exercises</h3>
<p>Consider a slightly different linear ODE:</p>
<p><span class="math display">\[
\frac{dx}{dt} =  0.2 x 
\]</span></p>
<ol style="list-style-type: decimal">
<li>Calculate the numeric solution of the ODE for <strong>one time step</strong> using Forward Euler, for time step dt=0.1, starting with initial value x(0) = 5. Answer: 5.1</li>
</ol>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="linear-ordinary-differential-equations.html#cb199-1" aria-hidden="true"></a><span class="co"># YOUR CODE HERE</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Write a script to solve the ODE using the Forward Euler method based on the outline above. Set the time step dt=0.1 and report the solution <strong>after 100 time steps</strong>. Answer: 36.22323</li>
</ol>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="linear-ordinary-differential-equations.html#cb200-1" aria-hidden="true"></a><span class="co"># YOUR CODE HERE</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Change the time step to be dt=0.01 and report the solution <strong>after 1000 time steps</strong>. Answer: 36.87156.</li>
</ol>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="linear-ordinary-differential-equations.html#cb201-1" aria-hidden="true"></a><span class="co"># YOUR CODE HERE</span></span></code></pre></div>
</div>
<div id="error-analysis" class="section level3" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> error analysis</h3>
<p>Numeric solutions of ODE are always approximate, because they use discrete time steps to approximate continuous change (derivatives). Thus numeric solutions always have <em>error</em>, which is the difference between the <em>exact</em> or <em>analytic</em> solution and the numeric solution. If we know the exact solution of an ODE, we can calculate the error using vector subtraction in R. For the same linear ODE we solved above:
<span class="math display">\[ 
\frac{dx}{dt} =  -0.5 x 
\]</span>
The analytic solution is <span class="math inline">\(x(t) = x_0 e^{-0.5t}\)</span>, where <span class="math inline">\(x_0\)</span> is the initial value. Here is an example of computing the numeric solution (as we did above) and then calculating the analytic solution and plotting it:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="linear-ordinary-differential-equations.html#cb202-1" aria-hidden="true"></a>x0 &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb202-2"><a href="linear-ordinary-differential-equations.html#cb202-2" aria-hidden="true"></a>dt &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="co"># set time step</span></span>
<span id="cb202-3"><a href="linear-ordinary-differential-equations.html#cb202-3" aria-hidden="true"></a>Tmax &lt;-<span class="st"> </span><span class="dv">10</span> <span class="co"># set length of time</span></span>
<span id="cb202-4"><a href="linear-ordinary-differential-equations.html#cb202-4" aria-hidden="true"></a>numstep &lt;-<span class="st"> </span>Tmax<span class="op">/</span>dt <span class="co"># assign number of time steps</span></span>
<span id="cb202-5"><a href="linear-ordinary-differential-equations.html#cb202-5" aria-hidden="true"></a>pop &lt;-<span class="st"> </span><span class="kw">rep</span>(x0, numstep<span class="op">+</span><span class="dv">1</span>) <span class="co"># initialize solution with y0</span></span>
<span id="cb202-6"><a href="linear-ordinary-differential-equations.html#cb202-6" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>numstep) { <span class="co"># do the Euler!</span></span>
<span id="cb202-7"><a href="linear-ordinary-differential-equations.html#cb202-7" aria-hidden="true"></a>	pop[i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>pop[i]<span class="op">+</span>dt<span class="op">*</span>(<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>pop[i])</span>
<span id="cb202-8"><a href="linear-ordinary-differential-equations.html#cb202-8" aria-hidden="true"></a>}</span>
<span id="cb202-9"><a href="linear-ordinary-differential-equations.html#cb202-9" aria-hidden="true"></a>time &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,Tmax, dt)</span>
<span id="cb202-10"><a href="linear-ordinary-differential-equations.html#cb202-10" aria-hidden="true"></a><span class="kw">plot</span>(time, pop, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">main =</span> <span class="st">&quot;Numeric and analytic solutions of an ODE&quot;</span>) <span class="co"># plot the numeric solution</span></span>
<span id="cb202-11"><a href="linear-ordinary-differential-equations.html#cb202-11" aria-hidden="true"></a>exact &lt;-<span class="st"> </span>x0<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>time) <span class="co"># calculate the exact solution</span></span>
<span id="cb202-12"><a href="linear-ordinary-differential-equations.html#cb202-12" aria-hidden="true"></a><span class="kw">lines</span>(time, exact, <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>) <span class="co"># plot the exact solution</span></span>
<span id="cb202-13"><a href="linear-ordinary-differential-equations.html#cb202-13" aria-hidden="true"></a><span class="kw">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;black&#39;</span>, <span class="st">&#39;red&#39;</span>), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;numeric&#39;</span>, <span class="st">&#39;analytic&#39;</span>))</span></code></pre></div>
<p><img src="QuantLife_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
<p>Now we can calculate the error of the numeric solution and plot it:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="linear-ordinary-differential-equations.html#cb203-1" aria-hidden="true"></a>error &lt;-<span class="st"> </span><span class="kw">abs</span>(exact <span class="op">-</span><span class="st"> </span>pop)</span>
<span id="cb203-2"><a href="linear-ordinary-differential-equations.html#cb203-2" aria-hidden="true"></a><span class="kw">plot</span>(time, error, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">main=</span><span class="st">&#39;Error of the numeric solution&#39;</span>)</span></code></pre></div>
<p><img src="QuantLife_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>
<p>What is the sources of this error? There are at least two distinct sources of error in numerical solutions: a)  and b) . Roundoff error is caused by computers representing real numbers by a finite string of bits on a computer using what is known as a  representation. In many programming languages variables storing real numbers can be single or double precision, which typically support 24 and 53 significant binary digits, respectively. Any arithmetic operation involving floating point numbers is only approximate, with an error that depends on the way the numbers are stored in the memory. Truncation error is caused by approximations inherent in numerical algorithms, such as Forward Euler, which represent instantaneous rate of change in an ODE with discrete steps and thus are always a bit off from the true analytic solution.</p>
<p>In practice, roundoff error is not a big concern in contemporary computation for most modelers. Truncation error, on the other hand, can cause big problems, but luckily it is within your control. One can decrease the error in the case of finite difference methods by choosing smaller time steps, or by choosing an algorithm with a higher <em>order of accuracy</em>, which we’ll leave for a more advanced discussion.</p>
<p>Returning specifically to the Forward Euler method, it is called a  <em>first-order method</em> because the total error of the solution (after some number of time steps) depends linearly on the time step <span class="math inline">\(\Delta t\)</span>. One can show this by using the Taylor expansion of the solution <span class="math inline">\(y(t)\)</span> to derive the forward Euler method, with <span class="math inline">\(\tau(\Delta t)\)</span> representing the truncation error after one time step:
<span class="math display">\[y(t+\Delta t) = y(t) +  \Delta t \frac {dy(t) }{dt} + \tau(\Delta t)\]</span>
As you might have learned in calculus, the error remaining after the linear term in the Taylor series is proportional to the the square of the small deviation <span class="math inline">\(\Delta t\)</span>. This only describes the error after 1 time step, but since the errors accumulate every time step, the total error after <span class="math inline">\(N\)</span> time steps accumulates <span class="math inline">\(N \tau(\Delta t)\)</span>. As we saw in the implementation above, for a given length of time, <span class="math inline">\(N\)</span> is inversely proportional to <span class="math inline">\(\Delta t\)</span>. Therefore, the total error is proportional to the <span class="math inline">\(\Delta t\)</span> and so FE is a first-order method.</p>
<p>The exercise above shows that new errors in FE method accumulate in proportion with the time step. The next question is, what happens to these errors over time? Do they grow or dissipate with more iterations? This is known as the stability of a numerical method, and unlike the above question about the order of accuracy, the answer depends on the particular ODE that one needs to solve. Below I show an example of error analysis for a linear ODE:</p>
<p><strong>Example.</strong> To numerically solve the equation <span class="math inline">\(\dot x = ax\)</span>, we substitute the function <span class="math inline">\(ax\)</span> for the function <span class="math inline">\(f(x,t)\)</span>, and obtain the FE approximation for this particular ODE:
<span class="math display">\[y_{i+1} = y_i + \Delta t a y_i = (1+a\Delta t) y_i\]</span>
The big question is what happens to the truncation error: does it grow or decay? To investigate this question, let us denote the error at time <span class="math inline">\(t_i\)</span> , that is the difference between the true solution <span class="math inline">\(x(t_i)\)</span> and the approximate solution <span class="math inline">\(y(t_i)\)</span>, by <span class="math inline">\(\epsilon_i\)</span>. It follows that <span class="math inline">\(y_i = x_i + \epsilon_i\)</span>. Then we can wrote the following difference equations involving the error:</p>
<p><span class="math display">\[y_{i+1} = x_{i+1} + \epsilon_{i+1} = (x_i + \epsilon_i) (1+a\Delta t)  = x_i (1+a\Delta t) + \epsilon_i(1+a\Delta t)\]</span>
Let us set aside the terns in the equation that involve <span class="math inline">\(x\)</span> (since it is just the equation for forward Euler). The remaining difference equation for <span class="math inline">\(\epsilon\)</span> describes the change in the error:
<span class="math display">\[\epsilon_{i+1} = \epsilon_i(1+a\Delta t) \]</span></p>
<p>This states that the error in this numerical solution is repeatedly multiplied by the constant <span class="math inline">\((1+a\Delta t)\)</span>. As we saw in section , this linear difference equation has an exponential solution <span class="math inline">\(\epsilon_n = (1+a\Delta t)^n \epsilon_0\)</span>, which decays to 0 if <span class="math inline">\(|1+a\Delta t| &lt; 1\)</span> or grows without bound if <span class="math inline">\(|1+a\Delta t| &gt; 1\)</span>. The first inequality is called the stability condition for the FE scheme, since it guarantees that the old errors decay over time. Since <span class="math inline">\(\Delta t &gt;0\)</span>, the only way that the left hand side can be less than 1 is if <span class="math inline">\(a&lt;0\)</span>. Therefore, the condition for stability of the FE method for a linear ODE:
<span class="math display">\[|1 + a\Delta t| &lt; 1 \Rightarrow \Delta t &lt; -2/a\]</span></p>
<p>Thus, if <span class="math inline">\(a&gt;0\)</span>, the errors will eventually overwhelm the solution. If <span class="math inline">\(a&lt;0\)</span>, if the time step is small enough (less than <span class="math inline">\(-2/a\)</span>) then FE is stable. Generally speaking, however, Forward Euler is about the worst method to use for practical numerical solutions of ODEs, due to its low accuracy and to its lack of stability under certain conditions.</p>
</div>
<div id="exercises-4" class="section level3" number="6.4.4">
<h3><span class="header-section-number">6.4.4</span> Exercises</h3>
<p><span class="math display">\[
\frac{dx}{dt} =  0.2 x 
\]</span></p>
<ol style="list-style-type: decimal">
<li>Calculate the error of the numeric solution of this ODE after one time step with dt=0.1 and initial value x(0) = 5 by subtracting it from the exact (analytic) solution <span class="math inline">\(x(t) = e^{0.2t}x(0)\)</span>, with the same initial value. Answer: about 0.001.</li>
</ol>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="linear-ordinary-differential-equations.html#cb204-1" aria-hidden="true"></a><span class="co"># YOUR CODE HERE</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Compute the error of the two numeric solution over Tmax = 10 by subtracting the numeric solution vector from the analytic solution calculating over the same time vector and report the mean of that error vector. Answers: for dt=0.1 the mean error is 0.722, for dt=0.01 the mean error is 0.0737.</li>
</ol>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="linear-ordinary-differential-equations.html#cb205-1" aria-hidden="true"></a><span class="co"># YOUR CODE HERE</span></span></code></pre></div>
</div>
</div>
<div id="applications-of-linear-ode-models" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Applications of linear ODE models</h2>
<p></p>
<div id="model-of-pharmacokinetics" class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> model of pharmacokinetics</h3>
<p>Describing and predicting the dynamics of drug concentration in the body is the goal of  <em>pharmacokinetics</em>. Any drug that humans take goes through several stages: first it is administered (put into the body), then absorbed, metabolized (transformed), and excreted (removed from the body) . Almost any drug has a dose at which it has a toxic effect, and most can kill a human if the dose is high enough. Drugs which are used for medical purposes have a <em>therapeutic range</em>, which lies between the lowest possible concentration (usually measured in the blood plasma) that achieves the therapeutic effect and the concentration which is toxic. One of the basic questions that medical practitioners need to know is how much and how frequently to administer a drug to maintain drug concentration in the therapeutic range.</p>
<p>The concentration of a drug is a dynamic variable which depends on the rates of several processes, most directly on the rate of administration and the rate of metabolism. Drugs can be  administered through various means (e.g. orally or intravenously) which influences their rate of absorption and thus how the concentration increases. Once in the blood plasma, drugs are metabolized primarily by enzymes in the liver, converting drug molecules into compounds that can be excreted through the kidneys or the large intestine. The process of  *metabolism proceeds at a rate that depends on both the concentration of the drug and on the enzyme that catalyzes the reaction. For some drugs the metabolic rate may be constant, or independent of the drug concentration, since the enzymes are already working at full capacity and can’t turn over any more reactions, for example alcohol is metabolized at a constant rate of about 1 drink per hours for most humans. Figure a shows the time plots of the blood alcohol concentration for 4 males who ingested different amounts of alcohol, and the curves are essentially linear with the same slope after the peak. For other drugs, if the plasma concentration is low enough, the enzymes are not occupied all the time and increasing the drug concentration leads to an increase in the rate of metabolism. One can see this behavior in the metabolism of the anti-depressant drug bupropion in figure b, where the concentration curve shows a faster decay rate for higher concentration of the drug than for lower concentration. In the simplest case, the rate of metabolism is linear, or proportional to the concentration of the drug, with proportionality constant called the first-order metabolic rate.</p>
<div class="figure">
<img src="ch15/aa35graf.png" alt="" />
<p class="caption">Blood alcohol content after ingesting different numbers of drinks, from 4 in the top curve to 1 in the bottom (figure from the National Institute on Alcohol Abuse and Alcoholism in public domain)</p>
</div>
<div class="figure">
<img src="ch15/2000px-Bupropion_bioequivalency.png" alt="" />
<p class="caption">Blood concentration of bupropion for two different drugs in clinical trials (image by CMBJ based on FDA data under CC-BY 3.0 via Wikimedia Commons)</p>
</div>
<p>Let us build an ODE model for a simplified pharmacokinetics situation. Suppose that a drug is administered at a constant rate of <span class="math inline">\(M\)</span> (concentration units per time unit) and that it is metabolized at a rate proportional to its plasma concentration <span class="math inline">\(C\)</span> with metabolic rate constant <span class="math inline">\(k\)</span>. Then the ODE model of the concentration of the drug over time <span class="math inline">\(C(t)\)</span> is:
<span class="math display">\[ \frac{dC}{dt} = M - kC\]</span>
The two rate constants <span class="math inline">\(M\)</span> and <span class="math inline">\(k\)</span> have different dimensions, which you should be able to determine yourself. The ODE can be solved using the separate-and-integrate method:</p>
<ol style="list-style-type: decimal">
<li>Divide both sides by the right hand side <span class="math inline">\(M-kC\)</span>, and multiply both sides by the differential <span class="math inline">\(dt\)</span>
<span class="math display">\[ \frac{dC}{M-kC} = dt\]</span></li>
<li>integrate both sides with respect to the different variables, don’t forget the integration constant!
<span class="math display">\[ \int \frac{dC}{M-kC} = \int dt \Rightarrow\]</span>
<span class="math display">\[ -\frac{1}{k} \log |M-kC| = t + A\]</span></li>
<li>solve for the dependent variable <span class="math inline">\(C(t)\)</span>
<span class="math display">\[ \exp(\log |M-kC| ) = -\exp(kt +A) \Rightarrow \]</span>
<span class="math display">\[  M - kC = B e^{-kt} \Rightarrow \]</span>
<span class="math display">\[ C(t) = \frac{M}{k}- Be^{-kt}\]</span>
Notice that I changed the values of integration constants <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> during the derivation, which shouldn’t matter because they have not been determined yet.</li>
<li>plug in <span class="math inline">\(t=0\)</span> and use the initial value <span class="math inline">\(x(0)\)</span> to solve for the integration constant
If we know the initial value <span class="math inline">\(C(0) = C_0\)</span>, then we can plug it in and get the following algebraic expression:
<span class="math display">\[ C_0 =  \frac{M}{k} - B \Rightarrow \]</span>
<span class="math display">\[ B = C_0 -  \frac{M}{k}\]</span>
Then the complete solution is:
<span class="math display">\[ C(t) =  \frac{M}{k} - (C_0- \frac{M}{k})e^{-kt}\]</span></li>
</ol>
<p>The solution predicts that after a long time the plasma concentration will approach the value <span class="math inline">\(M/k\)</span>, since the exponential term decays to zero. Notice that mathematically this is the same type of solution we obtained in equation  for a generic linear ODE with a constant term.</p>
</div>
<div id="discussion-questions" class="section level3" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Discussion questions</h3>
<ol style="list-style-type: decimal">
<li><p>Describe in words the dependence of the long-term plasma concentration of the drug on the parameters. Does this prediction make intuitive sense?</p></li>
<li><p>Explain in practical terms the assumption that the administration of the drug results in a constant rate of growth of the concentration. Under what circumstances does this match reality?}</p></li>
<li><p>Explain in practical terms the assumption that the drug metabolism rate is proportional to the plasma concentration. Under what circumstances does this match reality?}</p></li>
<li><p>Discuss how you could modify the ODE model to describe other circumstances, or to add other effects to it.}</p></li>
<li><p>The following questions encourage you to think critically about the pharmacokinetic model above.}</p></li>
</ol>
</div>
</div>
<div id="r-assignment" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> R Assignment</h2>
<p>In this part you will solve the linear population model ODE:
<span class="math display">\[ \frac{dN}{dt} = (b-d) N \]</span>
The model parameters are per capita birth and death rates (b and d, respectively), which may be expressed in percent population change per year (e.g. d= 0.12 is a death rate of 12% per year). Assume that the initial population is 500 individuals, and perform the following tasks:</p>
<ol style="list-style-type: decimal">
<li>Write a Forward Euler script to solve this ODE for any given values of b and d (they should be inputs into your defining function).</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Set b=0.5 and d=0.12, plot the numeric solution, and report whether the solution behaves as you would expect it to, for Tmax=50 and dt=0.1. Describe the behavior of the solution of the ODE over time.</li>
</ol>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="linear-ordinary-differential-equations.html#cb206-1" aria-hidden="true"></a><span class="co">#YOUR CODE HERE</span></span></code></pre></div>
<p>YOUR ANSWERS HERE</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Change the birth rate to b=0.01 and calculate the solution with the same initial value and same values of Tmax and dt. Plot the solution, describe its behavior, and compare its behavior to the one in the previous task.</li>
</ol>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="linear-ordinary-differential-equations.html#cb207-1" aria-hidden="true"></a><span class="co">#YOUR CODE HERE</span></span></code></pre></div>
<p>YOUR ANSWERS HERE</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Keeping b=0.01 and d=0.12, calculate the numeric solution of the ODE with different time steps: dt = 1, 5, 10. Plot the solutions and report how they behave for larger values of the time step. What time step would you consider optimal for this problem?</li>
</ol>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="linear-ordinary-differential-equations.html#cb208-1" aria-hidden="true"></a><span class="co">#YOUR CODE HERE</span></span></code></pre></div>
<p>YOUR ANSWERS HERE</p>
<ol start="2" style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li>Use your FE script to compute and plot the numerical solution of the ODE for b=0.5, d=0.12, with dt=0.1 over the span of 0 to 50 years. Calculate the analytic solution (see section 15.2) from the same time vector (0 to 50 with time step 0.1) and overlay the analytic solution on the same plot. Calculate and plot the vector of errors (absolute difference between the analytic and numerical solution) and plot it over time. Describe how the error behaves in this plot.</li>
</ol></li>
</ol>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="linear-ordinary-differential-equations.html#cb209-1" aria-hidden="true"></a><span class="co">#YOUR CODE HERE</span></span></code></pre></div>
<p>YOUR ANSWERS HERE</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Keeping the same parameters b=0.5 and d=0.12, calculate the mean error of the numerical solution by using the mean function on the absolute difference between the analytic solution vector and the numerical solution vector, for three values of the time step: dt=1, 0.1, 0.01 and Tmax=50. Report how the reduction in the error compares with each decrease in the time step.</li>
</ol>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="linear-ordinary-differential-equations.html#cb210-1" aria-hidden="true"></a><span class="co">#YOUR CODE HERE</span></span></code></pre></div>
<p>YOUR ANSWERS HERE</p>
<ol start="3" style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li>Use the birth rate to b=0.01, keep d=0.12 and again calculate and plot the numerical solution along with the analytic solution for the same values of Tmax and dt. Calculate and plot the vector of errors (absolute difference between the analytic and numerical solution) and plot it over time in a separate plot. Describe how the error behaves in this plot.</li>
</ol></li>
</ol>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="linear-ordinary-differential-equations.html#cb211-1" aria-hidden="true"></a><span class="co">#YOUR CODE HERE</span></span></code></pre></div>
<p>YOUR ANSWERS HERE</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Calculate the mean error of the numerical solution for three values of the time step: dt=1, 0.1, 0.01 with Tmax=50. Report how the reduction in the error compares with each decrease in the time step.</li>
</ol>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="linear-ordinary-differential-equations.html#cb212-1" aria-hidden="true"></a><span class="co">#YOUR CODE HERE</span></span></code></pre></div>
<p>YOUR ANSWERS HERE</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-difference-equations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graphical-analysis-of-ordinary-differential-equations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["QuantLife.pdf", "QuantLife.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
